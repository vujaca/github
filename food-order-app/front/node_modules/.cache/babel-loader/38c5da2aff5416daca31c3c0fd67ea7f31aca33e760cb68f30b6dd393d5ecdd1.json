{"ast":null,"code":"import jwt_decode from 'jwt-decode';\nimport { redirect } from 'react-router-dom';\nimport Axios from '../apis/Axios';\nexport const login = async function (username, password) {\n  const cred = {\n    username: username,\n    password: password\n  };\n  try {\n    const response = await Axios.post('korisnici/auth', cred);\n    const jwt_decoded = jwt_decode(response.data);\n    localStorage.setItem('jwt', response.data);\n    localStorage.setItem('role', jwt_decoded.role.authority);\n    const expiration = new Date();\n    expiration.setHours(expiration.getHours() + 1);\n    localStorage.setItem('expiration', expiration.toISOString());\n    setTimeout(() => {\n      window.location.replace('/');\n    }, 1000);\n  } catch (error) {\n    alert('Failed login');\n    console.log(error);\n  }\n};\nexport const logout = () => {\n  localStorage.removeItem('jwt');\n  localStorage.removeItem('role');\n  localStorage.removeItem('expiration');\n  window.location.replace('/');\n};\nexport const getAuthToken = () => {\n  const token = localStorage.getItem('jwt');\n  if (!token) {\n    return null;\n  }\n  return token;\n};\nexport const tokenLoader = () => {\n  return getAuthToken();\n};","map":{"version":3,"names":["jwt_decode","redirect","Axios","login","username","password","cred","response","post","jwt_decoded","data","localStorage","setItem","role","authority","expiration","Date","setHours","getHours","toISOString","setTimeout","window","location","replace","error","alert","console","log","logout","removeItem","getAuthToken","token","getItem","tokenLoader"],"sources":["C:/Users/Rajko Andjic/Desktop/Repository/github/food-order-app/front/src/services/auth.js"],"sourcesContent":["import jwt_decode from 'jwt-decode';\r\nimport { redirect } from 'react-router-dom';\r\nimport Axios from '../apis/Axios';\r\n\r\nexport const login = async function(username, password) {\r\n    const cred = {\r\n        username: username,\r\n        password: password\r\n    }\r\n\r\n    try {\r\n        const response = await Axios.post('korisnici/auth', cred)\r\n        const jwt_decoded = jwt_decode(response.data)\r\n        localStorage.setItem('jwt', response.data)\r\n        localStorage.setItem('role', jwt_decoded.role.authority)\r\n        const expiration = new Date()\r\n        expiration.setHours(expiration.getHours()+1)\r\n        localStorage.setItem('expiration', expiration.toISOString())\r\n        setTimeout(() => {\r\n            window.location.replace('/')\r\n        }, 1000)\r\n    } catch (error) {\r\n        alert('Failed login')\r\n        console.log(error);\r\n    }\r\n\r\n}\r\n\r\nexport const logout = () => {\r\n    localStorage.removeItem('jwt')\r\n    localStorage.removeItem('role')\r\n    localStorage.removeItem('expiration')\r\n    window.location.replace('/')\r\n}\r\n\r\nexport const getAuthToken = () => {\r\n    const token = localStorage.getItem('jwt')\r\n\r\n    if(!token) {\r\n        return null\r\n    }\r\n\r\n    return token;\r\n}\r\n\r\nexport const tokenLoader = () => {\r\n    return getAuthToken()\r\n}"],"mappings":"AAAA,OAAOA,UAAU,MAAM,YAAY;AACnC,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,OAAOC,KAAK,MAAM,eAAe;AAEjC,OAAO,MAAMC,KAAK,GAAG,eAAAA,CAAeC,QAAQ,EAAEC,QAAQ,EAAE;EACpD,MAAMC,IAAI,GAAG;IACTF,QAAQ,EAAEA,QAAQ;IAClBC,QAAQ,EAAEA;EACd,CAAC;EAED,IAAI;IACA,MAAME,QAAQ,GAAG,MAAML,KAAK,CAACM,IAAI,CAAC,gBAAgB,EAAEF,IAAI,CAAC;IACzD,MAAMG,WAAW,GAAGT,UAAU,CAACO,QAAQ,CAACG,IAAI,CAAC;IAC7CC,YAAY,CAACC,OAAO,CAAC,KAAK,EAAEL,QAAQ,CAACG,IAAI,CAAC;IAC1CC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEH,WAAW,CAACI,IAAI,CAACC,SAAS,CAAC;IACxD,MAAMC,UAAU,GAAG,IAAIC,IAAI,EAAE;IAC7BD,UAAU,CAACE,QAAQ,CAACF,UAAU,CAACG,QAAQ,EAAE,GAAC,CAAC,CAAC;IAC5CP,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEG,UAAU,CAACI,WAAW,EAAE,CAAC;IAC5DC,UAAU,CAAC,MAAM;MACbC,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,GAAG,CAAC;IAChC,CAAC,EAAE,IAAI,CAAC;EACZ,CAAC,CAAC,OAAOC,KAAK,EAAE;IACZC,KAAK,CAAC,cAAc,CAAC;IACrBC,OAAO,CAACC,GAAG,CAACH,KAAK,CAAC;EACtB;AAEJ,CAAC;AAED,OAAO,MAAMI,MAAM,GAAGA,CAAA,KAAM;EACxBjB,YAAY,CAACkB,UAAU,CAAC,KAAK,CAAC;EAC9BlB,YAAY,CAACkB,UAAU,CAAC,MAAM,CAAC;EAC/BlB,YAAY,CAACkB,UAAU,CAAC,YAAY,CAAC;EACrCR,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,GAAG,CAAC;AAChC,CAAC;AAED,OAAO,MAAMO,YAAY,GAAGA,CAAA,KAAM;EAC9B,MAAMC,KAAK,GAAGpB,YAAY,CAACqB,OAAO,CAAC,KAAK,CAAC;EAEzC,IAAG,CAACD,KAAK,EAAE;IACP,OAAO,IAAI;EACf;EAEA,OAAOA,KAAK;AAChB,CAAC;AAED,OAAO,MAAME,WAAW,GAAGA,CAAA,KAAM;EAC7B,OAAOH,YAAY,EAAE;AACzB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}